        <!doctype html>
        <html>
        <head>
            <title>SlideDeckMl_MLLS_Demo</title>
            <script src="https://cdn.socket.io/4.7.5/socket.io.min.js" crossorigin="anonymous"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

            <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>

            <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" 
                    onload="renderMathInElement(document.body, {
                    delimiters: [
                        {left: '$$', right: '$$', display: true},
                        {left: '$', right: '$', display: false}
                    ]
                    });"></script>

            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5/dist/reveal.css">
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5/dist/theme/solarized.css">
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5/plugin/highlight/monokai.css">
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">

            <style>
                /* Reset body margins/padding */
                body {
                    margin: 0;
                    padding: 0;
                    font-family: obot;
                    overflow: hidden;
                }

                /* Reveal.js viewport adjustment for header/footer */
                .reveal {
                    top: 80px !important;
                    height: calc(100% - 160px) !important;
                }

                .reveal .slides section {
                    height: 100% !important;
                    display: flex !important;
                    flex-direction: column;
                    justify-content: center;
                }

                /* Header & Footer Styling */
                .slide-header {
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    text-align: center;
                    font-size: 1.5rem;
                    opacity: 0.8;
                    border-bottom: 2px solid rgba(0,0,0,0.2);
                    padding: 1.5rem 2rem;
                    background: rgba(255,255,255,0.95);
                    z-index: 1000;
                    height: 80px;
                    box-sizing: border-box;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 1rem;
                }

                .slide-header img.theme-logo {
                    height: 50px;
                    max-width: 100px;
                    object-fit: contain;
                }

                .slide-footer {
                    position: fixed;
                    bottom: 0;
                    left: 0;
                    right: 0;
                    text-align: center;
                    font-size: 1.2rem;
                    opacity: 0.7;
                    border-top: 2px solid rgba(0,0,0,0.2);
                    padding: 1.2rem 2rem;
                    background: rgba(255,255,255,0.95);
                    z-index: 1000;
                    height: 80px;
                    box-sizing: border-box;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }

                .slide-header p,
                .slide-footer p {
                    margin: 0;
                    padding: 0;
                }

                .canvas-container {
                    position: absolute;
                    inset: 0;
                    pointer-events: none;
                    z-index: 10;
                }

                .canvas-container.active {
                    pointer-events: all;
                }

                /* Different cursors for each tools */
                .tool-pen,
                .tool-highlighter {
                    cursor: crosshair;
                }

                .tool-eraser {
                    cursor: cell;
                }

                .tool-text {
                    cursor: copy;
                }

                /* Text annotation */
                .floating-text {
                    position: absolute;
                    min-width: 50px;
                    z-index: 15;
                    color: #000;
                    font-weight: bold;
                    font-size: 30px;
                    border: 1px dashed transparent;
                    cursor: move;
                }

                .floating-text:focus {
                    border-color: #000;
                    outline: none;
                    background: rgba(255, 255, 255, 0.8);
                    cursor: text;
                }

                /* Style of the toolbar */
                #toolbar {
                    position: fixed;
                    bottom: 20px;
                    left: 20px;
                    z-index: 100;
                    background: rgba(255, 255, 255, 0.9);
                    padding: 12px;
                    border-radius: 8px;
                    display: flex;
                    gap: 10px;
                    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
                    font-family: sans-serif;
                }

                button {
                    cursor: pointer;
                    padding: 8px 15px;
                    border: 1px solid #ccc;
                    background: white;
                    border-radius: 5px;
                    font-size: 14px;
                }

                button.active {
                    background: #ffeb3b;
                    font-weight: bold;
                    border-color: #fbc02d;
                }

                .save-btn {
                    background: #4caf50;
                    color: white;
                }

                .sdml-quiz { border: 1px solid rgba(0,0,0,0.25); border-radius: 10px; padding: 14px; margin: 12px 0; }
                .sdml-quiz__title { font-size: 14px; letter-spacing: 0.02em; text-transform: uppercase; opacity: 0.85; margin-bottom: 6px; }
                .sdml-quiz__question { font-size: 22px; margin: 8px 0 12px; }
                .sdml-quiz__options { display: grid; gap: 8px; margin: 10px 0; }
                .sdml-quiz__options label { display: flex; gap: 10px; align-items: center; cursor: pointer; }
                .sdml-quiz__actions { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
                .sdml-quiz__input { border: 1px solid rgba(0,0,0,0.25); border-radius: 10px; padding: 10px 12px; font-size: 18px; min-width: 240px; }
                .sdml-quiz__btn { border: 0; border-radius: 10px; padding: 10px 12px; cursor: pointer; background: rgba(25,113,194,0.9); color: white; font-size: 14px; }
                .sdml-quiz__feedback { min-height: 1.2em; margin-top: 10px; font-weight: 600; }
                .sdml-quiz__results { margin-top: 10px; padding-top: 10px; border-top: 1px dashed rgba(0,0,0,0.25); }
            </style>
        </head>
        
        <body>
            <div id="toolbar">
                <button id="btn-pen" onclick="setTool('pen')">‚úèÔ∏è Stylo (D)</button>
                <button id="btn-highlighter" onclick="setTool('highlighter')">üñçÔ∏è Surligneur (H)</button>
                <button id="btn-text" onclick="setTool('text')">üî§ Texte (T)</button>
                <button id="btn-eraser" onclick="setTool('eraser')">üßΩ Gomme (E)</button>
                <button onclick="clearCurrentSlide()">üóëÔ∏è Effacer (C)</button>
                <button class="save-btn" onclick="exportAnnotatedHTML()">üíæ Sauvegarder (S)</button>
            </div>

            <div id="global-header" class="slide-header"></div>

            <div class="reveal">
                <div class="slides">
                    <section
                        id="slide1"
                        
                        data-transition="fade"
                        data-header="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: end center;
        place-content: end center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-style: italic; color: black; &quot;>
            SlideDeckML Framework Demo
        </div>
    </div>
</div>"
                        data-footer="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;color: black; &quot;>
            L. Brunet - MLLS Project
        </div>
    </div>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%; justify-content: flex-end; align-items: center;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%; justify-content: center; align-items: flex-end;color: black; &quot;>
            2024
        </div>
    </div>
</div>"
                        data-header-styles="background: hit; color: 2c3e5; font-size: 0p"
                        data-footer-styles="background: 2c3e5; color: hit"
                    >
                        <div  style="width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    width: 100%; 
        place-items: center center;
        place-content: center center;
    ">
                            <div class="fragment grow" style="width: 100%; height:100%;"><div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                <div class="text-box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-weight: bold; font-size: 80px; color: black; ">
                                    SlideDeckML
                                </div>
                            </div></div>
                            <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                <div class="text-box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-style: italic; color: gray; ">
                                    Le futur des pr√©sentations d√©claratives
                                </div>
                            </div>
                        </div>
                    </section>
                    <section
                        id="sommaire"
                        class="annotable"
                        data-transition="fade"
                        data-header="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: end center;
        place-content: end center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-style: italic; color: black; &quot;>
            SlideDeckML Framework Demo
        </div>
    </div>
</div>"
                        data-footer="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;color: black; &quot;>
            L. Brunet - MLLS Project
        </div>
    </div>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%; justify-content: flex-end; align-items: center;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%; justify-content: center; align-items: flex-end;color: black; &quot;>
            2024
        </div>
    </div>
</div>"
                        data-header-styles="background: hit; color: 2c3e5; font-size: 0p"
                        data-footer-styles="background: 2c3e5; color: hit"
                    >
                        <div  style="width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: start start;
        place-content: start start;
    ">
                            <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                <div class="text-box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-weight: bold; text-decoration: underline; color: black; ">
                                    Sommaire :
                                </div>
                            </div>
                                <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                    <div class="box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;">
                                        <ol class="sdml-list" style="--sdml-list-gap: 30px">
                                            <li>Mise en page & Bo√Ætes</li><li>Composants & Slots</li><li>√âquations Math√©matiques</li><li>Code & Interactivit√©</li><li>Multim√©dia & Vid√©os</li>
                            </ol>
                                </div>
                                </div>
                        </div>
                    </section>
                    <section
                        id="colonnes_demo"
                        class="annotable"
                        data-transition="fade"
                        data-header="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: end center;
        place-content: end center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-style: italic; color: black; &quot;>
            SlideDeckML Framework Demo
        </div>
    </div>
</div>"
                        data-footer="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;color: black; &quot;>
            L. Brunet - MLLS Project
        </div>
    </div>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%; justify-content: flex-end; align-items: center;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%; justify-content: center; align-items: flex-end;color: black; &quot;>
            2024
        </div>
    </div>
</div>"
                        data-header-styles="background: hit; color: 2c3e5; font-size: 0p"
                        data-footer-styles="background: 2c3e5; color: hit"
                    >
                        <div  style="width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(33.333333333333336% - 6.666666666666667px) calc(33.333333333333336% - 6.666666666666667px) calc(33.333333333333336% - 6.666666666666667px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 80%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    width: 100%; 
        place-items: center center;
        place-content: center center;
    ">
                            <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                <div class="text-box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;color: red; ">
                                    <span style="background-color: yellow; padding: 0 4px; border-radius: 2px;">Colonne 1 : Style Highlight</span>
                                </div>
                            </div>
                            <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                <div class="text-box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-weight: bold; color: green; ">
                                    Colonne 2 : Style Bold
                                </div>
                            </div>
                            <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                <div class="text-box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-style: italic; color: blue; ">
                                    Colonne 3 : Style Italic
                                </div>
                            </div>
                        </div>
                    </section>
                    <section
                        id="demo_slots"
                        class="annotable"
                        data-transition="fade"
                        data-header="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: end center;
        place-content: end center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-style: italic; color: black; &quot;>
            SlideDeckML Framework Demo
        </div>
    </div>
</div>"
                        data-footer="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;color: black; &quot;>
            L. Brunet - MLLS Project
        </div>
    </div>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%; justify-content: flex-end; align-items: center;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%; justify-content: center; align-items: flex-end;color: black; &quot;>
            2024
        </div>
    </div>
</div>"
                        data-header-styles="background: hit; color: 2c3e5; font-size: 0p"
                        data-footer-styles="background: 2c3e5; color: hit"
                    >
                        <div  style="
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    width: 100%; 
        place-items: center center;
        place-content: center center;
    ">
                            <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                <div class="text-box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-weight: bold; color: blue; ">
                                    Structure du Composant :
                                </div>
                            </div>
                            <div  style="width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    ">
                                <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                    <div class="text-box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-weight: bold; color: black; ">
                                        Contenu Inject√© dans le Slot !
                                    </div>
                                </div>
                                <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                    <div class="box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;">
                                        <img 
                                            src="https://images4.alphacoders.com/133/thumb-1920-1332281.jpeg" 
                                            alt="Logo Demo" 
                                            style="
        display: block;
        max-width: 100%;
        max-height: 100%;
        object-fit: contain;
    
            width: 40%;
            height: auto;
        " 
                                        />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                    <section
                        id="mathematics_slide"
                        class="annotable"
                        data-transition="fade"
                        data-header="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: end center;
        place-content: end center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-style: italic; color: black; &quot;>
            SlideDeckML Framework Demo
        </div>
    </div>
</div>"
                        data-footer="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;color: black; &quot;>
            L. Brunet - MLLS Project
        </div>
    </div>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%; justify-content: flex-end; align-items: center;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%; justify-content: center; align-items: flex-end;color: black; &quot;>
            2024
        </div>
    </div>
</div>"
                        data-header-styles="background: hit; color: 2c3e5; font-size: 0p"
                        data-footer-styles="background: 2c3e5; color: hit"
                    >
                        <div  style="width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(100% - 0px); 
        grid-template-rows: calc(10% - 5px) calc(90% - 5px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    ">
                            <div class="box-wrapper" style="display: flex; width: 100%; height: 100%; justify-content: flex-start; align-items: flex-start;">
                                <div class="text-box" style="display: flex; flex-direction: column; width: 100%; height: 100%; justify-content: flex-start; align-items: flex-start;font-size: 1.2em; color: black; ">
                                    D√©monstration d'une formule math√©matique
                                </div>
                            </div>
                            <div  style="width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(60% - 5px) calc(40% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    ">
                                <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                    <div class="text-box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;text-decoration: underline; color: black; ">
                                        Voici un exemple d'une formule math√©matique complexe que nous pouvons afficher simplement
                                    </div>
                                </div>
                                <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                    <div class="box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;">
                                        <div class="math-box" style="color: black; ">
                                            <div class="math-content">
                                                $\zeta(s) = \sum_{n=1}^{\infty} \frac{1}{n^s} = \prod_{p \in \text{primes}} \frac{1}{1 - p^{-s}}$
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                    <section
                        id="code_slide"
                        class="annotable"
                        data-transition="fade"
                        data-header="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: end center;
        place-content: end center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-style: italic; color: black; &quot;>
            SlideDeckML Framework Demo
        </div>
    </div>
</div>"
                        data-footer="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;color: black; &quot;>
            L. Brunet - MLLS Project
        </div>
    </div>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%; justify-content: flex-end; align-items: center;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%; justify-content: center; align-items: flex-end;color: black; &quot;>
            2024
        </div>
    </div>
</div>"
                        data-header-styles="background: hit; color: 2c3e5; font-size: 0p"
                        data-footer-styles="background: 2c3e5; color: hit"
                    >
                        <div  style="width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    ">
                            <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                <div class="text-box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-weight: bold; color: black; ">
                                    D√©monstration de Code Source :
                                </div>
                            </div>
                            <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                <div class="box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-size: 14px; color: black; ">
                                    <div class="code-box-container" style="display: flex; flex-wrap: wrap; gap: 1rem; width: fit-content;">
                                        <div style="flex: 2; min-width: 0;">
                                            <pre style="margin: 0; overflow: auto;"><code data-noescape class="language-java" data-line-numbers="1|2|3|4|5|6">        public class Main {
            public static void main(String[] args) {
                System.out.println("Hello SlideDeckML");
            }
        }
        </code></pre>
                                        </div>
                                        <div class="image-stack" style="flex: 1; min-width: 0; display: grid; place-items: center; overflow: hidden;">
                                            <div class="code-step-image" data-start="3" data-end="4"
                                                 style="grid-area: 1 / 1; opacity: 1; transition: opacity 0.3s; width: 100%; display: flex; justify-content: center; align-items: center;">
                                                <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                                    <div class="box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;">
                                                        <img 
                                                            src="https://logo.png" 
                                                            alt="Explaining line 3" 
                                                            style="
        display: block;
        max-width: 100%;
        max-height: 100%;
        object-fit: contain;
    
            width: 50%;
            height: auto;
        " 
                                                        />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                    <section
                        id="quiz_slide"
                        class="annotable"
                        data-transition="fade"
                        data-header="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: end center;
        place-content: end center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-style: italic; color: black; &quot;>
            SlideDeckML Framework Demo
        </div>
    </div>
</div>"
                        data-footer="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;color: black; &quot;>
            L. Brunet - MLLS Project
        </div>
    </div>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%; justify-content: flex-end; align-items: center;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%; justify-content: center; align-items: flex-end;color: black; &quot;>
            2024
        </div>
    </div>
</div>"
                        data-header-styles="background: hit; color: 2c3e5; font-size: 0p"
                        data-footer-styles="background: 2c3e5; color: hit"
                    >
                        <div class="fragment fade-up" style="width: 100%; height:100%;"><div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                            <div class="box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;">
                                <div
                                    class="sdml-quiz"
                                    data-quiz-id="q1"
                                    data-quiz-type="mcq"
                                    data-correct-answer="c"
                                    data-reveal-on-demand="true"
                                >
                                    <div class="sdml-quiz__title">Quiz</div>
                                    <div class="sdml-quiz__question">Quel terminal d√©finit une expression LaTeX dans notre BNF ?</div>

                            <div class="sdml-quiz__options">
                                <label>
                                    <input type="radio" name="quiz-q1" value="a" />
                                    <span>TEXT</span>
                                </label><label>
                                    <input type="radio" name="quiz-q1" value="b" />
                                    <span>STRING</span>
                                </label><label>
                                    <input type="radio" name="quiz-q1" value="c" />
                                    <span>MATH_EXPR</span>
                                </label>
                            </div>
                            <div class="sdml-quiz__actions">
                                <button
                                    class="sdml-quiz__btn sdml-quiz__submit"
                                    type="button"
                                            onclick="(function(btn){const r=btn.closest('.sdml-quiz');if(!r)return;const c=(r.getAttribute('data-correct-answer')||'').trim();const f=r.querySelector('.sdml-quiz__feedback');if(!f)return;const ch=r.querySelector('input[type=radio]:checked');if(!ch)return;const v=(ch.value||'').trim();const ok=v.toLowerCase()===c.toLowerCase();f.textContent=ok?'Correct.':'Not quite.';f.style.color=ok?'#2aa198':'#dc322f';if(!ok){const res=r.querySelector('.sdml-quiz__results');if(res){res.style.display='block';}const rb=r.querySelector('.sdml-quiz__reveal');if(rb)rb.style.display='none';} })(this)"
                                >Submit</button>
                            </div>

                                    <div class="sdml-quiz__feedback" aria-live="polite"></div>
                                    <div class="sdml-quiz__reveal-wrap">
                                        <button class="sdml-quiz__btn sdml-quiz__reveal" type="button" onclick="(function(btn){const r=btn.closest('.sdml-quiz');if(!r)return;const res=r.querySelector('.sdml-quiz__results');if(res){res.style.display='block';}btn.style.display='none';})(this)">Reveal answer</button>
                                        <div class="sdml-quiz__results" style="display:none">Correct answer: <strong>c</strong></div>
                                    </div>
                                </div>
                            </div>
                        </div></div>
                    </section>
                    <section
                        id="live_quiz_slide"
                        class="annotable"
                        data-transition="fade"
                        data-header="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: end center;
        place-content: end center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-style: italic; color: black; &quot;>
            SlideDeckML Framework Demo
        </div>
    </div>
</div>"
                        data-footer="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;color: black; &quot;>
            L. Brunet - MLLS Project
        </div>
    </div>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%; justify-content: flex-end; align-items: center;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%; justify-content: center; align-items: flex-end;color: black; &quot;>
            2024
        </div>
    </div>
</div>"
                        data-header-styles="background: hit; color: 2c3e5; font-size: 0p"
                        data-footer-styles="background: 2c3e5; color: hit"
                    >
                            <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                <div class="box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;">
                                    <div class="sdml-quiz live-quiz" id="quiz-lq1" data-correct-answer="yes">
                                        <div class="sdml-quiz__title">Live Quiz</div>
                                        <div class="sdml-quiz__question">√ätes-vous convaincus par le DSL ?</div>
                                
                                <div style="display: flex; gap: 20px; align-items: flex-start;">
                                    <div class="sdml-quiz__options" style="flex: 1;">
                                                <div class="live-option-row" style="margin: 8px 0; display: flex; justify-content: space-between; background: #fff; padding: 10px; border-radius: 4px; border: 1px solid #ddd;">
                                                    <span>Oui</span>
                                                    <span class="vote-count" data-option="Oui" style="font-weight: bold; color: #007bff;">0</span>
                                                </div><div class="live-option-row" style="margin: 8px 0; display: flex; justify-content: space-between; background: #fff; padding: 10px; border-radius: 4px; border: 1px solid #ddd;">
                                                    <span>Absolument</span>
                                                    <span class="vote-count" data-option="Absolument" style="font-weight: bold; color: #007bff;">0</span>
                                                </div>
                        </div>

                                    <div class="sdml-quiz__qr-container" style="display: flex; flex-direction: column; align-items: center; gap: 8px;">
                                        <div id="qr-lq1" style="border: 2px solid #ddd; border-radius: 8px; padding: 6px; background: #fff;"></div>
                                        <div style="font-size: 12px; color: #666;">Scan to vote</div>
                                        </div>
                                        </div>

                                <div class="sdml-quiz__actions" style="margin-top: 15px;">
                                            <div class="sdml-quiz__results" style="margin-top: 10px; padding: 10px; background: #e0f2f1; border-radius: 4px;">
                                                Correct answer: <strong>yes</strong>
                                            </div>
                        </div>

                            <script>
                                    (function() {
                                const quizId = "lq1";
                                const sessionId = "SESSION123";
                                const options = ["Oui","Absolument"];
                                const voteCounts = {};


                                options.forEach(opt => { voteCounts[opt] = 0; });

                                const renderQRCode = (url) => {
                                    const qrEl = document.getElementById("qr-" + quizId);
                                    if (!qrEl) return;

                                    qrEl.innerHTML = '';

                                    if (typeof QRCode === 'function') {
                                        const level = (QRCode.CorrectLevel && QRCode.CorrectLevel.M) ? QRCode.CorrectLevel.M : undefined;
                                        new QRCode(qrEl, {
                                            text: String(url || ''),
                                            width: 150,
                                            height: 150,
                                            ...(level ? { correctLevel: level } : {})
                                        });
                                        return;
                                    }
                                };

                                const updateQRCodeFromGlobal = () => {
                                    const url = window["sdmlMobileVoteUrl"] || "http://localhost:3000/vote";
                                    renderQRCode(url);
                                };

                                const initQuiz = (socket) => {

                                    socket.emit("register-quiz", {
                                        sessionId: sessionId,
                                        question: "√ätes-vous convaincus par le DSL ?",
                                        options: options
                                    });

                                    socket.on("qcm-results-update", (v) => {

                                        voteCounts[v.choice] = (voteCounts[v.choice] || 0) + 1;

                                        const quizEl = document.getElementById("quiz-" + quizId);
                                        const countEl = quizEl.querySelector('.vote-count[data-option="' + v.choice + '"]');
                                        if (countEl) {
                                            countEl.textContent = voteCounts[v.choice];
                                            countEl.style.transform = "scale(1.2)";
                                            setTimeout(() => { countEl.style.transform = "scale(1)"; }, 200);
                                        }
                                    })();
                                </script>
                                    </div>
                                </div>
                            </div>
                    </section>
                    <section
                        id="video_demo"
                        class="annotable"
                        data-transition="fade"
                        data-header="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: end center;
        place-content: end center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-style: italic; color: black; &quot;>
            SlideDeckML Framework Demo
        </div>
    </div>
</div>"
                        data-footer="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;color: black; &quot;>
            L. Brunet - MLLS Project
        </div>
    </div>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%; justify-content: flex-end; align-items: center;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%; justify-content: center; align-items: flex-end;color: black; &quot;>
            2024
        </div>
    </div>
</div>"
                        data-header-styles="background: hit; color: 2c3e5; font-size: 0p"
                        data-footer-styles="background: 2c3e5; color: hit"
                    >
                        <div  style="width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(100% - 0px); 
        grid-template-rows: calc(10% - 5px) calc(90% - 5px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    ">
                            <div class="box-wrapper" style="display: flex; width: 100%; height: 100%; justify-content: flex-start; align-items: flex-start;">
                                <div class="text-box" style="display: flex; flex-direction: column; width: 100%; height: 100%; justify-content: flex-start; align-items: flex-start;font-size: 1.2em; color: black; ">
                                    Vid√©os dans vos pr√©sentations
                                </div>
                            </div>
                            <div  style="width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(60% - 5px) calc(40% - 5px); 
        grid-template-rows: calc(50% - 5px) calc(50% - 5px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    ">
                                <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                    <div class="text-box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-size: 1em; color: black; ">
                                        Voici une superbe musique d'un youtubeur assez connu mais qui commence √† dater
                                    </div>
                                </div>
                                <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                    <div class="box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;">
                                        <iframe
                                            src="https://www.youtube.com/embed/uGSu6mhk3RQ"
                                            title="Top 1 Squeezie"
                                            style="
        display: block;
        aspect-ratio: 16 / 9;
        width: auto;
        height: auto;
        max-width: 100%;
        max-height: 100%;
        border: 0;
    "
                                            allowfullscreen>
                                        </iframe>
                                    </div>
                                </div>
                                <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                    <div class="text-box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-size: 1em; color: black; ">
                                        Voici une autre musique mais que j'aime moins et que j'affiche donc plus petite
                                    </div>
                                </div>
                                <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                    <div class="box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;">
                                        <iframe
                                            src="https://www.youtube.com/embed/AMShoQ_qdc0"
                                            title="Hello World Song"
                                            style="
        display: block;
        aspect-ratio: 16 / 9;
        width: auto;
        height: auto;
        max-width: 50%;
        max-height: 100%;
        border: 0;
    "
                                            allowfullscreen>
                                        </iframe>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                    <section
                        id="image_demo"
                        class="annotable"
                        data-transition="fade"
                        data-header="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: end center;
        place-content: end center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-style: italic; color: black; &quot;>
            SlideDeckML Framework Demo
        </div>
    </div>
</div>"
                        data-footer="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;color: black; &quot;>
            L. Brunet - MLLS Project
        </div>
    </div>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%; justify-content: flex-end; align-items: center;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%; justify-content: center; align-items: flex-end;color: black; &quot;>
            2024
        </div>
    </div>
</div>"
                        data-header-styles="background: hit; color: 2c3e5; font-size: 0p"
                        data-footer-styles="background: 2c3e5; color: hit"
                    >
                        <div  style="width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(100% - 0px); 
        grid-template-rows: calc(10% - 6.666666666666667px) calc(45% - 6.666666666666667px) calc(45% - 6.666666666666667px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    ">
                            <div class="box-wrapper" style="display: flex; width: 100%; height: 100%; justify-content: flex-start; align-items: flex-start;">
                                <div class="text-box" style="display: flex; flex-direction: column; width: 100%; height: 100%; justify-content: flex-start; align-items: flex-start;font-size: 1.2em; color: black; ">
                                    Images dans vos pr√©sentations
                                </div>
                            </div>
                            <div  style="width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(60% - 5px) calc(40% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    ">
                                <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                    <div class="text-box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-size: 1em; color: black; ">
                                        Vous pouvez aussi int√©grer des images dans vos slides
                                    </div>
                                </div>
                                <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                    <div class="box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;">
                                        <img 
                                            src="https://www.recyclivre.com/blog/wp-content/uploads/2025/03/couvsiteluffy.jpeg" 
                                            alt="Luffy" 
                                            style="
        display: block;
        max-width: 100%;
        max-height: 100%;
        object-fit: contain;
    
            width: fit-content; 
            height: auto;
        " 
                                        />
                                    </div>
                                </div>
                            </div>
                            <div  style="width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(60% - 5px) calc(40% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    ">
                                <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                    <div class="text-box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-size: 1em; color: black; ">
                                        Voici une photo plus petite
                                    </div>
                                </div>
                                <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                    <div class="box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;">
                                        <img 
                                            src="https://images4.alphacoders.com/133/thumb-1920-1332281.jpeg" 
                                            alt="Gojo" 
                                            style="
        display: block;
        max-width: 100%;
        max-height: 100%;
        object-fit: contain;
    
            width: 30%;
            height: auto;
        " 
                                        />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                    <section
                        id="position_demo"
                        class="annotable"
                        data-transition="fade"
                        data-header="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: end center;
        place-content: end center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-style: italic; color: black; &quot;>
            SlideDeckML Framework Demo
        </div>
    </div>
</div>"
                        data-footer="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;color: black; &quot;>
            L. Brunet - MLLS Project
        </div>
    </div>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%; justify-content: flex-end; align-items: center;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%; justify-content: center; align-items: flex-end;color: black; &quot;>
            2024
        </div>
    </div>
</div>"
                        data-header-styles="background: hit; color: 2c3e5; font-size: 0p"
                        data-footer-styles="background: 2c3e5; color: hit"
                    >
                        <div  style="width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    
        place-items: center center;
        place-content: center center;
    ">
                            <div class="box-wrapper" style="display: flex; width: 100%; height: 100%; justify-content: flex-start; align-items: flex-start;">
                                <div class="text-box" style="display: flex; flex-direction: column; width: 100%; height: 100%; justify-content: flex-start; align-items: flex-start;color: red; ">
                                    <span style="background-color: yellow; padding: 0 4px; border-radius: 2px;">Ce texte est forc√© en haut √† gauche</span>
                                </div>
                            </div>
                            <div class="box-wrapper" style="display: flex; width: 100%; height: 100%; justify-content: flex-end; align-items: flex-end;">
                                <div class="text-box" style="display: flex; flex-direction: column; width: 100%; height: 100%; justify-content: flex-end; align-items: flex-end;font-style: italic; color: black; ">
                                    Celui-ci est en bas √† droite
                                </div>
                            </div>
                        </div>
                    </section>
                    <section
                        id="nested_demo"
                        class="annotable"
                        data-transition="fade"
                        data-header="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: end center;
        place-content: end center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-style: italic; color: black; &quot;>
            SlideDeckML Framework Demo
        </div>
    </div>
</div>"
                        data-footer="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;color: black; &quot;>
            L. Brunet - MLLS Project
        </div>
    </div>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%; justify-content: flex-end; align-items: center;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%; justify-content: center; align-items: flex-end;color: black; &quot;>
            2024
        </div>
    </div>
</div>"
                        data-header-styles="background: hit; color: 2c3e5; font-size: 0p"
                        data-footer-styles="background: 2c3e5; color: hit"
                    >
                        <div  style="width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    width: 100%; 
        place-items: center center;
        place-content: center center;
    ">
                            <div  style="width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    ">
                                <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                    <div class="text-box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;color: black; ">
                                        Conteneur Interne 1
                                    </div>
                                </div>
                            </div>
                            <div  style="width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    ">
                                <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                    <div class="box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;">
                                        <img 
                                            src="https://images4.alphacoders.com/133/thumb-1920-1332281.jpeg" 
                                            alt="Img1" 
                                            style="
        display: block;
        max-width: 100%;
        max-height: 100%;
        object-fit: contain;
    
            width: 90%;
            height: auto;
        " 
                                        />
                                    </div>
                                </div>
                                <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                    <div class="box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;">
                                        <img 
                                            src="https://images4.alphacoders.com/133/thumb-1920-1332281.jpeg" 
                                            alt="Img2" 
                                            style="
        display: block;
        max-width: 100%;
        max-height: 100%;
        object-fit: contain;
    
            width: 90%;
            height: auto;
        " 
                                        />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                    <section
                        id="conclusion"
                        class="annotable"
                        data-transition="fade"
                        data-header="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: end center;
        place-content: end center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-style: italic; color: black; &quot;>
            SlideDeckML Framework Demo
        </div>
    </div>
</div>"
                        data-footer="<div  style=&quot;width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    &quot;>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;color: black; &quot;>
            L. Brunet - MLLS Project
        </div>
    </div>
    <div class=&quot;box-wrapper&quot; style=&quot;display: flex; width: 100%; height: 100%; justify-content: flex-end; align-items: center;&quot;>
        <div class=&quot;text-box&quot; style=&quot;display: flex; flex-direction: column; width: 100%; height: 100%; justify-content: center; align-items: flex-end;color: black; &quot;>
            2024
        </div>
    </div>
</div>"
                        data-header-styles="background: hit; color: 2c3e5; font-size: 0p"
                        data-footer-styles="background: 2c3e5; color: hit"
                    >
                        <div  style="width: 100%; height:100%; 
        display: grid; 
        grid-template-columns: calc(50% - 5px) calc(50% - 5px); 
        grid-template-rows: calc(100% - 0px);
        gap: 10px;
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        box-sizing: border-box;
        overflow: hidden;
    height: 100%; width: 100%; 
        place-items: center center;
        place-content: center center;
    ">
                            <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                <div class="text-box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;font-weight: bold; font-size: 1.5em; color: black; ">
                                    Merci de votre attention !
                                </div>
                            </div>
                                <div class="box-wrapper" style="display: flex; width: 100%; height: 100%;">
                                    <div class="box" style="display: flex; flex-direction: column; width: 100%; height: 100%;place-items: center center; place-content: center center;">
                                        <ul class="sdml-list" style="--sdml-list-gap: 0px">
                                            <li>Questions ?</li><li>GitHub : slide-deck-ml</li>
                            </ul>
                                </div>
                                </div>
                        </div>
                    </section>
                </div>
            </div>

            <div id="global-footer" class="slide-footer"></div>
            
            <script id="annotation-storage">window.savedPaths = {};</script>

            <script src="https://cdn.jsdelivr.net/npm/reveal.js@5/dist/reveal.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/reveal.js@5/plugin/highlight/highlight.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/qrcodejs2@0.0.2/qrcode.min.js"></script>
            <script src="http://localhost:3000/socket.io/socket.io.js"></script>
    <script>
        window.addEventListener('DOMContentLoaded', () => {
            if (typeof io !== 'undefined') {
                const host = (window.location.protocol === 'file:') ? 'localhost' : window.location.hostname;
                const serverUrl = "http://" + host + ":3000";

                const socket = io(serverUrl, {
                    reconnection: false,
                    reconnectionAttempts: 0,
                    timeout: 2000
                });

                window["sdmlMobileVoteUrl"] = "http://localhost:3000/vote";
                
                socket.on("connect", () => {
                    console.log("Connected to:", serverUrl);
                    socket.emit("join-session", "SESSION123");
                });

                let sdmlShownConnectError = false;
                socket.on("connect_error", (err) => {
                    if (sdmlShownConnectError) return;
                    sdmlShownConnectError = true;
                    console.warn("Socket.IO server not reachable:", serverUrl);
                    try { socket.close(); } catch {}
                });

                socket.on("mobile-ip", (url) => {
                    if (typeof url === 'string' && url.length > 0) {
                        window["sdmlMobileVoteUrl"] = url;
                        window.dispatchEvent(new CustomEvent('sdml-mobile-ip', { detail: { url } }));
                        console.log('QR URL:', url);
                    }
                });

                window["sdmlSocket"] = socket; 
            }
        });
    </script>
            <script>
            const updateCodeStepImage = (codeBoxContainer, lineIndex) => {
                if (!codeBoxContainer) return;
                const images = Array.from(codeBoxContainer.querySelectorAll('.code-step-image'));
                if (images.length === 0) return;

                images.forEach(img => {
                    img.style.opacity = '0';
                    img.style.zIndex = '1';
                });

                if (!lineIndex || lineIndex < 1) return;

                // If multiple ranges overlap, the last matching one wins.
                let active = null;
                for (const img of images) {
                    const startAttr = img.getAttribute('data-start');
                    const endAttr = img.getAttribute('data-end');
                    const start = startAttr ? Number(startAttr) : NaN;
                    const end = endAttr ? Number(endAttr) : start;
                    if (Number.isFinite(start) && lineIndex >= start && lineIndex <= end) {
                        active = img;
                    }
                }

                if (active) {
                    active.style.opacity = '1';
                    active.style.zIndex = '10';
                }
            };

            const updateAllCodeBoxesInSlide = (slideEl, lineIndex) => {
                if (!slideEl) return;
                const boxes = Array.from(slideEl.querySelectorAll('.code-box-container'));
                for (const box of boxes) {
                    updateCodeStepImage(box, lineIndex);
                }
            };

            const parseLineNumberSpecStart = (spec) => {
                if (!spec) return 1;
                const s = String(spec).trim();
                if (!s) return 1;
                const first = s.split('-')[0];
                const n = Number(first);
                return Number.isFinite(n) && n >= 1 ? n : 1;
            };

            const currentHighlightedLineForBox = (codeBoxContainer) => {
                if (!codeBoxContainer) return 1;
                const fragCandidates = Array.from(codeBoxContainer.querySelectorAll('.fragment[data-line-numbers]'));
                const visible = fragCandidates.filter(f => f.classList.contains('visible') || f.classList.contains('current-fragment'));
                const activeFrag = visible.length > 0 ? visible[visible.length - 1] : null;
                if (activeFrag) {
                    const spec = activeFrag.getAttribute('data-line-numbers');
                    if (spec) return parseLineNumberSpecStart(spec);
                }

                const codeEl = codeBoxContainer.querySelector('pre code');
                const stepsAttr = codeEl ? (codeEl.getAttribute('data-line-numbers') || '') : '';
                const steps = stepsAttr.split('|').map(s => s.trim()).filter(Boolean);
                if (steps.length === 0) return 1;

                const slideF = Reveal.getIndices().f;
                const candidates = (typeof slideF === 'number') ? [slideF, slideF - 1, slideF + 1, 0] : [0];
                for (const idx of candidates) {
                    if (idx >= 0 && idx < steps.length) {
                        return parseLineNumberSpecStart(steps[idx]);
                    }
                }

                return parseLineNumberSpecStart(steps[0]);
            };
                // Theme logo URL
                const THEME_LOGO_URL = "https://upload.wikimedia.org/wikipedia/commons/thumb/3/3a/Logo_Universit%C3%A9_C%C3%B4te_d%27Azur.svg/320px-Logo_Universit%C3%A9_C%C3%B4te_d%27Azur.svg.png";

                Reveal.initialize({
                    plugins: [RevealHighlight],
                    hash: true,
                    slideNumber: true,
                    transition: 'slide',
                    width: "100%",
                    height: "100%",
                    margin: 0.1,
                    backgroundTransition: 'fade',
                    center: true
                });

                const syncCodeBoxImages = (slideEl) => {
                    if (!slideEl) return;
                    const boxes = Array.from(slideEl.querySelectorAll('.code-box-container'));
                    for (const box of boxes) {
                        updateCodeStepImage(box, currentHighlightedLineForBox(box));
                    }
                };

                Reveal.on('ready', (event) => {
                    syncCodeBoxImages(event.currentSlide);
                });

                Reveal.on('slidechanged', (event) => {
                    syncCodeBoxImages(event.currentSlide);
                });

                Reveal.on('fragmentshown', () => {
                    syncCodeBoxImages(Reveal.getCurrentSlide());
                });

                Reveal.on('fragmenthidden', () => {
                    syncCodeBoxImages(Reveal.getCurrentSlide());
                });

                // Update header/footer when slide changes
                Reveal.on('slidechanged', event => {
                    const currentSlide = event.currentSlide;
                    const headerDiv = document.getElementById('global-header');
                    const footerDiv = document.getElementById('global-footer');

                    const headerContent = currentSlide.getAttribute('data-header');
                    const footerContent = currentSlide.getAttribute('data-footer');
                    const headerStyles = currentSlide.getAttribute('data-header-styles');
                    const footerStyles = currentSlide.getAttribute('data-footer-styles');

                    if (headerContent) {
                        // Add logo if theme has one
                        let finalHeaderContent = headerContent;
                        if (THEME_LOGO_URL) {
                            finalHeaderContent = '<img src="' + THEME_LOGO_URL + '" alt="Logo" class="theme-logo" />' + headerContent;
                        }

                        headerDiv.innerHTML = finalHeaderContent;
                        headerDiv.style.display = 'block';
                        if (headerStyles) {
                            headerDiv.style.cssText += '; ' + headerStyles;
                        }
                    } else {
                        headerDiv.style.display = 'none';
                    }

                    if (footerContent) {
                        footerDiv.innerHTML = footerContent;
                        footerDiv.style.display = 'block';
                        if (footerStyles) {
                            footerDiv.style.cssText += '; ' + footerStyles;
                        }
                    } else {
                        footerDiv.style.display = 'none';
                    }
                });

                // Trigger initial update
                Reveal.on('ready', event => {
                    Reveal.dispatchEvent({ type: 'slidechanged', currentSlide: event.currentSlide });
                });

                let currentTool = null;
                let isDrawing = false;
                const allCanvases = {};

                document.querySelectorAll('.slides section.annotable').forEach(section => {
                    const canvas = document.createElement('canvas');
                    canvas.className = 'canvas-container';
                    canvas.width = window.innerWidth;
                    canvas.height = window.innerHeight;
                    section.appendChild(canvas);

                    const id = section.id || 'slide-' + Math.random().toString(36).substr(2, 5);
                    section.id = id;
                    allCanvases[id] = canvas;
                    setupEvents(canvas, section);

                    section.querySelectorAll('.floating-text').forEach(txt => makeDraggable(txt, section));
                });

                function updateToolbarVisibility(currentSlide) {
                    const toolbar = document.getElementById('toolbar');
                    if (currentSlide.classList.contains('annotable')) {
                        toolbar.style.display = 'flex';
                    } else {
                        toolbar.style.display = 'none';
                        setTool(null);
                    }
                }

                function setTool(tool) {
                    currentTool = (currentTool === tool) ? null : tool;
                    document.querySelectorAll('#toolbar button').forEach(btn => btn.classList.remove('active'));
                    if (currentTool) document.getElementById(`btn-${ currentTool }`).classList.add('active');

                    document.querySelectorAll('.canvas-container').forEach(c => {
                        c.className = `canvas-container ${ currentTool ? 'active tool-' + currentTool : '' } `;
                    });
                }

                function setupEvents(canvas, section) {
                    const ctx = canvas.getContext('2d');
                    ctx.lineCap = 'round';
                    ctx.lineJoin = 'round';

                    if (window.savedPaths[section.id]) {
                        const img = new Image();
                        img.onload = () => ctx.drawImage(img, 0, 0);
                        img.src = window.savedPaths[section.id];
                    }

                    canvas.onmousedown = (e) => {
                        if (!currentTool) return;
                        if (currentTool === 'text') { createTextElement(section, e); return; }

                        isDrawing = true;
                        const rect = canvas.getBoundingClientRect();
                        ctx.beginPath();
                        ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);

                        ctx.globalCompositeOperation = 'source-over';
                        ctx.globalAlpha = 1.0;
                        ctx.lineWidth = 50;

                        if (currentTool === 'eraser') {
                            ctx.globalCompositeOperation = 'destination-out';
                        } else if (currentTool === 'highlighter') {
                            ctx.strokeStyle = '#ffff00';
                            ctx.globalAlpha = 0.015;
                        } else {
                            ctx.strokeStyle = '#ff0000';
                            ctx.lineWidth = 4;
                        }
                    };

                    canvas.onmousemove = (e) => {
                        if (!isDrawing) return;
                        const rect = canvas.getBoundingClientRect();
                        ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
                        ctx.stroke();
                    };
                    window.addEventListener('mouseup', () => isDrawing = false);
                }

                function createTextElement(section, e) {
                    const txt = document.createElement('div');
                    txt.className = 'floating-text';
                    txt.contentEditable = true;
                    const rect = section.getBoundingClientRect();
                    txt.style.left = (e.clientX - rect.left) + "px";
                    txt.style.top = (e.clientY - rect.top) + "px";

                    makeDraggable(txt, section);
                    section.appendChild(txt);
                    setTimeout(() => txt.focus(), 10);
                }

                function makeDraggable(txt, section) {
                    txt.onmousedown = (e) => {
                        if (document.activeElement === txt) return;
                        e.preventDefault();
                        const onMove = (ev) => {
                            const sRect = section.getBoundingClientRect();
                            txt.style.left = (ev.clientX - sRect.left - 20) + "px";
                            txt.style.top = (ev.clientY - sRect.top - 10) + "px";
                        };
                        window.addEventListener('mousemove', onMove);
                        window.addEventListener('mouseup', () => window.removeEventListener('mousemove', onMove), { once: true });
                    };
                }

                function clearCurrentSlide() {
                    const canvas = Reveal.getCurrentSlide().querySelector('canvas');
                    if (canvas) canvas.getContext('2d').clearRect(0, 0, canvas.width, canvas.height);
                    Reveal.getCurrentSlide().querySelectorAll('.floating-text').forEach(t => t.remove());
                }

                function exportAnnotatedHTML() {
                    const canvasData = {};
                    for (const id in allCanvases) {
                        const url = allCanvases[id].toDataURL();
                        if (url.length > 1000) canvasData[id] = url;
                    }

                    const clone = document.documentElement.cloneNode(true);

                    clone.querySelector('#toolbar')?.remove();

                    clone.querySelectorAll('.canvas-container').forEach(c => c.remove());

                    clone.querySelector('#annotation-storage').innerText = `window.savedPaths = ${ JSON.stringify(canvasData) }; `;

                    const blob = new Blob(["<!DOCTYPE html>", String.fromCharCode(10), clone.outerHTML], { type: 'text/html' });
                    const a = document.createElement('a');
                    a.href = URL.createObjectURL(blob);
                    a.download = "presentation_finale.html";
                    a.click();
                }

                function exportAnnotatedHTML() {
                    const data = {};
                    for (const id in allCanvases) {
                        const url = allCanvases[id].toDataURL();
                        if (url.length > 1000) data[id] = url;
                    }
                    const clone = document.documentElement.cloneNode(true);
                    clone.querySelector('#toolbar')?.remove();
                    clone.querySelectorAll('.canvas-container').forEach(c => c.remove());
                    clone.querySelector('#annotation-storage').innerText = `window.savedPaths = ${ JSON.stringify(data) }; `;

                    const a = document.createElement('a');
                    a.href = URL.createObjectURL(new Blob(["<!DOCTYPE html>\
" + clone.outerHTML], { type: 'text/html' }));
                    a.download = "presentation.html";
                    a.click();
                }

                document.addEventListener('keydown', (e) => {
                    const key = e.key.toLowerCase();
                    if (key === 'escape') {
                        if (document.activeElement) document.activeElement.blur();
                        setTool(null);
                        return;
                    }
                    if (document.activeElement.contentEditable === "true") return;
                    if (key === 'd') setTool('pen');
                    if (key === 'h') setTool('highlighter');
                    if (key === 't') setTool('text');
                    if (key === 'e') setTool('eraser');
                    if (key === 'c') clearCurrentSlide();
                    if (key === 's') exportAnnotatedHTML();
                });

                Reveal.on('ready', event => {
                    updateToolbarVisibility(event.currentSlide);
                });

                Reveal.on('slidechanged', event => {
                    updateToolbarVisibility(event.currentSlide);
                });
            </script>
        </body>
        </html>
